# expect: comp-1
# Test RHtml with explicit state passing

import stdlib.reactiveWeb
import stdlib.html

reactive Counter = { value: Int }

main() = {
    # Create initial state
    state = emptyRenderState()

    # Create a reactive counter
    counter = Counter(value: 0)

    # Render with RHtml - this tracks dependencies automatically
    (html, state1, compId) = rhtmlRoot(state, "comp", () => {
        # Reading counter.value is tracked by VM
        Element("div", [], [Text("Count: " ++ show(counter.value))])
    })

    # Verify component was created
    # Change counter - should queue the component for re-render
    counter.value = 42

    # Get pending rerenders (components that need updating)
    pending = getPendingRerenders()

    match pending {
        [id] -> id
        [] -> "none"
        _ -> "multiple"
    }
}

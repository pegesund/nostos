# expect: 0
# Test Exec.readStderr for streaming stderr

main() = {
    # Spawn a process that outputs to stderr then exits
    handle = Exec.start("sh", ["-c", "echo stderr line >&2"])

    # Read stderr
    line = Exec.readStderr(handle)

    # Verify the output
    assert(line == "stderr line\n")

    # Wait for process to complete
    exitCode = Exec.wait(handle)
    assert(exitCode == 0)

    0
}

# expect: 5
# Option flatMap with typed result

type Option[T] = Some(T) | None

flatMap(f, opt) = match opt {
    Some(x) -> f(x)
    None -> None
}

safeDiv(a, b) = if b == 0 then None else Some(a / b)

unwrap(opt) = match opt {
    Some(x) -> x
    None -> 0
}

main() = {
    maybe: Option[Int] = Some(10)
    result: Option[Int] = flatMap(x => safeDiv(x, 2), maybe)
    unwrap(result)
}

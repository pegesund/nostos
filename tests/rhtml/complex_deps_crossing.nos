# expect: 3
# Complex: 3 reactive records, multiple components reading various combinations

reactive User = { name: String }
reactive Theme = { color: String }
reactive Config = { debug: Bool }

# Component reading only User
userOnly(user: User) = RHtml(p(user.name))

# Component reading only Theme
themeOnly(theme: Theme) = RHtml(p(theme.color))

# Component reading User and Theme
userAndTheme(user: User, theme: Theme) = RHtml(p(user.name ++ " - " ++ theme.color))

# Component reading all three
allThree(user: User, theme: Theme, config: Config) = RHtml(
    if config.debug then p(user.name ++ " [" ++ theme.color ++ "] DEBUG")
    else p(user.name ++ " [" ++ theme.color ++ "]")
)

main() = {
    user = User("Alice")
    theme = Theme("blue")
    config = Config(true)
    
    result = RHtml(div([
        component("user-only", () => userOnly(user)),
        component("theme-only", () => themeOnly(theme)),
        component("user-theme", () => userAndTheme(user, theme)),
        component("all", () => allThree(user, theme, config))
    ]))
    
    # Should have 3 entries in deps (User, Theme, Config)
    Map.size(result.deps)
}

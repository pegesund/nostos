# expect: 3
# Complex: 3 reactive records, multiple components reading various combinations

use stdlib.rhtml.*

reactive User = { name: String }
reactive Theme = { color: String }
reactive Config = { debug: Bool }

main() = {
    user = User("Alice")
    theme = Theme("blue")
    config = Config(true)

    # Component reading only User
    userOnly = () => RHtml(p(user.name))

    # Component reading only Theme
    themeOnly = () => RHtml(p(theme.color))

    # Component reading User and Theme
    userAndTheme = () => RHtml(p(user.name ++ " - " ++ theme.color))

    # Component reading all three
    allThree = () => RHtml(
        if config.debug then p(user.name ++ " [" ++ theme.color ++ "] DEBUG")
        else p(user.name ++ " [" ++ theme.color ++ "]")
    )

    result = RHtml(div([
        component("user-only", userOnly),
        component("theme-only", themeOnly),
        component("user-theme", userAndTheme),
        component("all", allThree)
    ]))

    # Should have 3 entries in deps (User, Theme, Config)
    Map.size(result.deps)
}

# expect: 28
# Binary tree operations

type Tree[T] = Leaf | Node(T, Tree[T], Tree[T])

# Sum all values in tree
sum_tree(Leaf) = 0
sum_tree(Node(v, left, right)) = v + sum_tree(left) + sum_tree(right)

# Build a tree:
#       4
#      / \
#     2   6
#    / \ / \
#   1  3 5  7
# Sum = 1+2+3+4+5+6+7 = 28

main() = {
    tree = Node(4,
        Node(2, Node(1, Leaf, Leaf), Node(3, Leaf, Leaf)),
        Node(6, Node(5, Leaf, Leaf), Node(7, Leaf, Leaf))
    )
    sum_tree(tree)
}

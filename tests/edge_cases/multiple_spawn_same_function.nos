# expect: 0
# Spawn same function multiple times

worker(parent, id) = {
    parent <- id
}

main() = {
    me = self()
    spawn { worker(me, 1) }
    spawn { worker(me, 2) }
    spawn { worker(me, 3) }

    # Receive all three (order may vary)
    a = receive { x -> x }
    b = receive { x -> x }
    c = receive { x -> x }

    # Sum should be 1+2+3=6
    assert_eq(6, a + b + c)
    0
}

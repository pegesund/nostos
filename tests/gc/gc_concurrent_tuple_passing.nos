# expect: ()
# GC handles tuples passed between processes

worker(parent, t) = {
    garbage = (999, 888, 777)
    (a, b, c) = t
    result = a + b + c
    parent <- result
}

main() = {
    me = self()

    # Create tuples and pass to workers
    spawn { worker(me, (1, 2, 3)) }
    spawn { worker(me, (10, 20, 30)) }
    spawn { worker(me, (100, 200, 300)) }

    # Collect results
    var total = 0
    for i = 0 to 3 {
        total = receive
            r -> total + r
        end
    }

    # 6 + 60 + 600 = 666
    assert_eq(666, total)
}

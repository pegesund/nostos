# expect: 0
# GC preserves map structures

check_map(m) = match m {
    %{"key": val} -> val
    _ -> 0
}

build_map(0, m) = m
build_map(n, m) = {
    garbage = %{"garbage": 0, "temp": 999}
    new_m = %{"key": n}
    build_map(n - 1, new_m)
}

main() = {
    m = build_map(100, %{})
    val = check_map(m)
    assert_eq(1, val)
    0
}

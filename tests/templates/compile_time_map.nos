# expect: 30
# Test compile-time map for generating multiple functions
# For single-constructor types (type Point = Point {...}), .fields returns
# the fields directly, not a list of constructors

template withGetters(typeDef) = quote {
    ~typeDef
    # Generate a getter for each field
    ~typeDef.fields.map(f => eval("get_" ++ f.name ++ "(r: " ++ ~typeDef.name ++ ") = r." ++ f.name))
}

@withGetters
type Point = Point { x: Int, y: Int }

main() = {
    p = Point(x: 10, y: 20)
    get_x(p) + get_y(p)  # 10 + 20 = 30
}

# expect: 0
# Test new List operations from stdlib

main() = {
    # Test sum
    nums = [1, 2, 3, 4, 5]
    assert(sum(nums) == 15)
    assert(sum([]) == 0)

    # Test product
    assert(product(nums) == 120)
    assert(product([]) == 1)

    # Test indexOf
    assert(indexOf(nums, 3) == Some(2))
    assert(indexOf(nums, 10) == None)
    assert(indexOf([], 1) == None)

    # Test sortBy
    pairs = [(3, "c"), (1, "a"), (2, "b")]
    sorted = sortBy(pairs, (a, b) => {
        (x, _) = a
        (y, _) = b
        if x < y then -1 else if x > y then 1 else 0
    })
    (first, _) = head(sorted)
    assert(first == 1)

    # Test intersperse
    letters = ["a", "b", "c"]
    spersed = intersperse(letters, "-")
    assert(length(spersed) == 5)
    assert(nth(spersed, 1) == "-")

    # Test spanList
    (left, right) = spanList([1, 2, 3, 4, 5], x => x < 4)
    assert(length(left) == 3)
    assert(length(right) == 2)
    assert(head(right) == 4)

    # Test groupBy
    nums2 = [1, 1, 2, 2, 2, 3, 3]
    groups = groupBy(nums2, x => x)
    assert(length(groups) == 3)
    assert(length(head(groups)) == 2)

    # Test transpose
    matrix = [[1, 2, 3], [4, 5, 6]]
    transposed = transpose(matrix)
    assert(length(transposed) == 3)
    assert(head(head(transposed)) == 1)

    # Test pairwise
    diffs = pairwise([1, 3, 6, 10], (a, b) => b - a)
    assert(length(diffs) == 3)
    assert(head(diffs) == 2)

    # Test isSorted
    assert(isSorted([1, 2, 3, 4, 5]))
    assert(isSorted([]))
    assert(isSorted([1]))
    assert(!isSorted([3, 1, 2]))

    println("All List tests passed!")
    0
}

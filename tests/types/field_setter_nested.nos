# expect: 100
# Test nested field setter dispatch

# Define mutable records
var type Inner = { value: Int }
var type Outer = { inner: Inner }

# Define setters for both levels
innerSetValue(i: Inner, v: Int) -> Inner = {
    # Custom setter: multiply by 10
    Inner(v * 10)
}

outerSetInner(o: Outer, i: Inner) -> Outer = {
    # Custom setter: just updates the inner
    Outer(i)
}

main() = {
    o = Outer(Inner(1))

    # This should:
    # 1. Call innerSetValue(o.inner, 10) to get new inner with value 100
    # 2. Call outerSetInner(o, newInner) to get new outer
    # 3. Update o with the result
    o.inner.value = 10

    # value should be 10 * 10 = 100
    o.inner.value
}

# expect: 0
# Closures stored in collections

main() = {
    # List of closures
    add1 = x => x + 1
    add2 = x => x + 2
    add3 = x => x + 3
    funcs = [add1, add2, add3]

    # Apply each function
    results = funcs.map(f => f(10))
    test1 = results == [11, 12, 13]

    # Closures capturing different values
    multipliers = [1, 2, 3].map(n => x => x * n)
    test2 = multipliers.get(0)(5) == 5
    test3 = multipliers.get(1)(5) == 10
    test4 = multipliers.get(2)(5) == 15

    # Filter with closure
    threshold = 5
    nums = [1, 3, 5, 7, 9]
    filtered = nums.filter(n => n > threshold)
    test5 = filtered == [7, 9]

    # Reduce with closure
    initial = 100
    sum = nums.fold(0, (acc, n) => acc + n)
    test6 = sum == 25

    if test1 && test2 && test3 && test4 && test5 && test6 then 0 else 1
}

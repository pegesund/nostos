# Test: Option/Maybe chaining
type Maybe = Just(Int) | Nothing

mapMaybe(_, Nothing) = Nothing
mapMaybe(f, Just(x)) = Just(f(x))

flatMapMaybe(_, Nothing) = Nothing
flatMapMaybe(f, Just(x)) = f(x)

safeDiv(_, 0) = Nothing
safeDiv(a, b) = Just(a / b)

getOr(Just(x), _) = x
getOr(Nothing, d) = d

main() = {
    result = flatMapMaybe(
        x => flatMapMaybe(
            y => Just(x + y),
            safeDiv(20, 4)
        ),
        safeDiv(100, 5)
    )
    getOr(result, -1)
}

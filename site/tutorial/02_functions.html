<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Functions - Nostos Tutorial</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <style>
        .hljs-operator {
            color: #e06c75; /* A distinct red/orange for operators */
        }
        .hljs-function {
            color: #e5c07b; /* A distinct yellow/gold for functions */
        }
    </style>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        nostos: {
                            dark: '#0f172a',
                            primary: '#3b82f6',
                            accent: '#10b981',
                            code: '#1e293b'
                        }
                    },
                    fontFamily: {
                        mono: ['ui-monospace', 'SFMono-Regular', 'Menlo', 'Monaco', 'Consolas', "Liberation Mono", "Courier New", 'monospace'],
                    }
                }
            }
        }
    </script>

    

    <style>
        html, body { max-width: 100vw; overflow-x: hidden; }
        pre { max-width: 100%; overflow-x: auto; white-space: pre; }
        code { word-break: break-word; }
        p, li, h1, h2, h3, h4 { word-wrap: break-word; overflow-wrap: break-word; }
        .prose { max-width: 100%; }
        article, main, .content { max-width: 100%; overflow-x: hidden; }
        * { box-sizing: border-box; }
        @media (max-width: 768px) {
            .flex-1 { min-width: 0; }
            pre { font-size: 12px; }
        }
    </style>
</head>
<body class="bg-slate-900 text-slate-200 font-sans antialiased overflow-x-hidden">

        <!-- Navbar -->
    <nav class="border-b border-slate-800 bg-slate-900/80 backdrop-blur fixed w-full z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16 items-center">
                <div class="flex items-center">
                    <button id="mobile-menu-btn" class="md:hidden text-slate-300 hover:text-white mr-3">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                        </svg>
                    </button>
                    <a href="../index.html" class="text-2xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-blue-400 to-emerald-400">Nostos</a>
                    <span class="ml-4 text-slate-400 border-l border-slate-700 pl-4 text-sm font-medium hidden sm:inline">Tutorial</span>
                </div>
                <div class="hidden md:flex space-x-6">
                    <a href="../index.html" class="text-slate-400 hover:text-white transition">Home</a>
                    <a href="https://github.com/pegesund/nostos" class="text-slate-400 hover:text-white transition">GitHub</a>
                </div>
                
            </div>
        </div>
        <div id="mobile-menu" class="hidden md:hidden border-t border-slate-800 bg-slate-900">
            <div class="px-4 py-3 space-y-2">
                <a href="../index.html" class="block text-slate-300 hover:text-white transition py-2">Home</a>
                <a href="https://github.com/pegesund/nostos" class="block text-slate-300 hover:text-white transition py-2">GitHub</a>
                <div class="border-t border-slate-700 pt-3 mt-3">
                    <div class="text-xs text-slate-500 uppercase font-semibold mb-2">Chapters</div>
                    <div id="mobile-chapters"><a href="00_installation.html" class="block text-slate-300 hover:text-white py-1 text-sm">0. Installation</a>
                    <a href="01_basics.html" class="block text-slate-300 hover:text-white py-1 text-sm">1. Basics</a>
                    <a href="02_functions.html" class="block text-slate-300 hover:text-white py-1 text-sm">2. Functions</a>
                    <a href="03_pattern_matching.html" class="block text-slate-300 hover:text-white py-1 text-sm">3. Pattern Matching</a>
                    <a href="04_lists_tuples.html" class="block text-slate-300 hover:text-white py-1 text-sm">4. Lists & Tuples</a>
                    <a href="05_maps_sets.html" class="block text-slate-300 hover:text-white py-1 text-sm">5. Maps & Sets</a>
                    <a href="06_typed_arrays.html" class="block text-slate-300 hover:text-white py-1 text-sm">6. Typed Arrays</a>
                    <a href="07_type_system.html" class="block text-slate-300 hover:text-white py-1 text-sm">7. Type System</a>
                    <a href="08_traits.html" class="block text-slate-300 hover:text-white py-1 text-sm">8. Traits</a>
                    <a href="09_builtin_traits.html" class="block text-slate-300 hover:text-white py-1 text-sm">9. Builtin Traits</a>
                    <a href="10_trait_bounds.html" class="block text-slate-300 hover:text-white py-1 text-sm">10. Trait Bounds</a>
                    <a href="11_error_handling.html" class="block text-slate-300 hover:text-white py-1 text-sm">11. Error Handling</a>
                    <a href="12_modules.html" class="block text-slate-300 hover:text-white py-1 text-sm">12. Modules</a>
                    <a href="13_stdlib.html" class="block text-slate-300 hover:text-white py-1 text-sm">13. Std Library</a>
                    <a href="14_json.html" class="block text-slate-300 hover:text-white py-1 text-sm">14. JSON</a>
                    <a href="15_concurrency.html" class="block text-slate-300 hover:text-white py-1 text-sm">15. Concurrency</a>
                    <a href="16_async_runtime.html" class="block text-slate-300 hover:text-white py-1 text-sm">16. Async Runtime</a>
                    <a href="17_async_io_http.html" class="block text-slate-300 hover:text-white py-1 text-sm">17. Async I/O</a>
                    <a href="18_reflection.html" class="block text-slate-300 hover:text-white py-1 text-sm">18. Reflection</a>
                    <a href="19_debugging_profiling.html" class="block text-slate-300 hover:text-white py-1 text-sm">19. Debugging</a>
                    <a href="20_html_templating.html" class="block text-slate-300 hover:text-white py-1 text-sm">20. HTML</a>
                    <a href="21_mutability.html" class="block text-slate-300 hover:text-white py-1 text-sm">21. Mutability</a>
                    <a href="23_complete_web_app.html" class="block text-slate-300 hover:text-white py-1 text-sm">22. Web App</a>
                    <a href="24_ffi.html" class="block text-slate-300 hover:text-white py-1 text-sm">23. FFI</a>
                    <a href="25_command_line.html" class="block text-slate-300 hover:text-white py-1 text-sm">24. CLI</a>
                    <a href="26_reactive_records.html" class="block text-slate-300 hover:text-white py-1 text-sm">25. Reactive Records</a>
                    <a href="27_reactive_web.html" class="block text-slate-300 hover:text-white py-1 text-sm">26. RWeb</a>
                    <a href="28_logging.html" class="block text-slate-300 hover:text-white py-1 text-sm">27. Logging</a>
                    <a href="29_selenium.html" class="block text-slate-300 hover:text-white py-1 text-sm">28. Selenium</a>
                    <a href="30_tcp_sockets.html" class="block text-slate-300 hover:text-white py-1 text-sm">29. TCP Sockets</a>
                    <a href="31_vscode.html" class="block text-slate-300 hover:text-white py-1 text-sm">30. VS Code</a></div>
                </div>
            </div>
        </div>
    </nav>
    <script>
        document.getElementById('mobile-menu-btn').addEventListener('click', function() {
            document.getElementById('mobile-menu').classList.toggle('hidden');
        });
    </script>

    <div class="pt-16 flex min-h-screen">
        
        <!-- Sidebar -->
        <aside id="tutorial-sidebar" class="w-64 fixed top-16 h-[calc(100vh-4rem)] border-r border-slate-800 bg-slate-900 overflow-y-auto hidden md:block pb-8">
            <div class="p-6">
                <h3 class="text-xs font-semibold text-slate-500 uppercase tracking-wider mb-4">Contents</h3>
                                <ul class="space-y-3">
                    <li><a href="01_basics.html" class="block text-slate-400 hover:text-white transition">1. Basics</a></li>
                    <li><a href="02_functions.html" class="block text-blue-400 font-medium">2. Functions</a></li>
                    <li><a href="03_pattern_matching.html" class="block text-slate-400 hover:text-white transition">3. Pattern Matching</a></li>
                    <li><a href="04_lists_tuples.html" class="block text-slate-400 hover:text-white transition">4. Lists & Tuples</a></li>
                    <li><a href="05_maps_sets.html" class="block text-slate-400 hover:text-white transition">5. Maps & Sets</a></li>
                    <li><a href="06_typed_arrays.html" class="block text-slate-400 hover:text-white transition">6. Typed Arrays</a></li>
                    <li><a href="07_type_system.html" class="block text-slate-400 hover:text-white transition">7. Type System</a></li>
                    <li><a href="08_traits.html" class="block text-slate-400 hover:text-white transition">8. Traits</a></li>
                    <li><a href="09_builtin_traits.html" class="block text-slate-400 hover:text-white transition">9. Builtin Traits</a></li>
                    <li><a href="10_trait_bounds.html" class="block text-slate-400 hover:text-white transition">10. Trait Bounds</a></li>
                    <li><a href="11_error_handling.html" class="block text-slate-400 hover:text-white transition">11. Error Handling</a></li>
                    <li><a href="12_modules.html" class="block text-slate-400 hover:text-white transition">12. Modules & Imports</a></li>
                    <li><a href="13_stdlib.html" class="block text-slate-400 hover:text-white transition">13. Standard Library</a></li>
                    <li><a href="14_json.html" class="block text-slate-400 hover:text-white transition">14. JSON</a></li>
                    <li><a href="15_concurrency.html" class="block text-slate-400 hover:text-white transition">15. Concurrency</a></li>
                    <li><a href="16_async_runtime.html" class="block text-slate-400 hover:text-white transition">16. Async Runtime</a></li>
                    <li><a href="17_async_io_http.html" class="block text-slate-400 hover:text-white transition">17. Async I/O & HTTP</a></li>
                    <li><a href="18_reflection.html" class="block text-slate-400 hover:text-white transition">18. Reflection & Eval</a></li>
                    <li><a href="19_debugging_profiling.html" class="block text-slate-400 hover:text-white transition">19. Debugging & Profiling</a></li>
                    <li><a href="20_html_templating.html" class="block text-slate-400 hover:text-white transition">20. HTML Templating</a></li>
                    <li><a href="21_mutability.html" class="block text-slate-400 hover:text-white transition">21. Mutability</a></li>
                    <li><a href="23_complete_web_app.html" class="block text-slate-400 hover:text-white transition">22. Complete Web App</a></li>
                </ul>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="flex-1 md:ml-64 p-8 max-w-4xl">
            <div class="mb-12">
                <h1 class="text-4xl font-bold text-white mb-6">Functions</h1>
                <p class="text-lg text-slate-400 leading-relaxed mb-8">
                    Functions are first-class citizens in Nostos. They are defined using a concise syntax and can be passed around like any other value.
                </p>

                <!-- Basic Functions -->
                <h2 class="text-2xl font-semibold text-white mb-4">Defining Functions</h2>
                <p class="text-slate-400 mb-4">Simple functions are defined using the <code>name(args) = body</code> syntax.</p>
                <div class="bg-nostos-code rounded-lg p-6 mb-8 border border-slate-800 overflow-x-auto">
<pre style="max-width:100%;overflow-x:auto"><code class="language-nostos">
add(a, b) = a + b
double(x) = x * 2

main() = {
    result_add = add(5, 3)    # result_add is 8
    result_double = double(4) # result_double is 8
}
</code></pre>
                </div>

                <!-- Lambdas -->
                <h2 class="text-2xl font-semibold text-white mb-4">Lambda Expressions</h2>
                <p class="text-slate-400 mb-4">Anonymous functions, or lambdas, are defined using the <code>args => body</code> syntax.</p>
                <div class="bg-nostos-code rounded-lg p-6 mb-8 border border-slate-800 overflow-x-auto">
<pre style="max-width:100%;overflow-x:auto"><code class="language-nostos">
# Lambdas can be defined inside functions
main() = {
    multiply = (a, b) => a * b
    increment = x => x + 1

    product = multiply(6, 7)   # product is 42
    next_val = increment(10)   # next_val is 11

    println(product)
}

# Or as regular functions at top-level
multiply(a, b) = a * b
increment(x) = x + 1
</code></pre>
                </div>

                <!-- Higher-Order Functions -->
                <h2 class="text-2xl font-semibold text-white mb-4">Higher-Order Functions</h2>
                <p class="text-slate-400 mb-4">
                    Higher-order functions (HOFs) are functions that can take other functions as arguments, or return functions as their results. This is a powerful feature for abstracting common patterns and writing more concise, reusable code.
                </p>

                <h3 class="text-xl font-semibold text-white mb-3">Functions as Arguments</h3>
                <p class="text-slate-400 mb-4">You can pass functions (including lambdas) as arguments to other functions.</p>
                <div class="bg-nostos-code rounded-lg p-6 mb-8 border border-slate-800 overflow-x-auto">
<pre style="max-width:100%;overflow-x:auto"><code class="language-nostos">
# apply a function 'f' to a value 'x'
apply(f, x) = f(x)

# apply a function 'f' twice to a value 'x'
twice(f, x) = f(f(x))

main() = {
    increment = x => x + 1
    double = x => x * 2

    # apply increment to 5
    result1 = apply(increment, 5) # result1 is 6

    # apply double twice to 3
    result2 = twice(double, 3)    # result2 is 12 (double(double(3)))
}
</code></pre>
                </div>

                <h3 class="text-xl font-semibold text-white mb-3">Functions as Return Values (Closures)</h3>
                <p class="text-slate-400 mb-4">Functions can also return new functions, often "capturing" values from their environment. These are known as closures.</p>
                <div class="bg-nostos-code rounded-lg p-6 mb-8 border border-slate-800 overflow-x-auto">
<pre style="max-width:100%;overflow-x:auto"><code class="language-nostos">
# Returns a function that adds 'n' to its input
make_adder(n) = x => x + n

main() = {
    add5 = make_adder(5)
    add10 = make_adder(10)

    result1 = add5(2)  # result1 is 7
    result2 = add10(2) # result2 is 12
}
</code></pre>
                </div>

                <h3 class="text-xl font-semibold text-white mb-3">Common HOF Patterns (Map & Filter)</h3>
                <p class="text-slate-400 mb-4">Higher-order functions are frequently used to implement powerful data transformation patterns like <code>map</code> and <code>filter</code>.</p>
                <div class="bg-nostos-code rounded-lg p-6 mb-8 border border-slate-800 overflow-x-auto">
<pre style="max-width:100%;overflow-x:auto"><code class="language-nostos">
# The stdlib provides map and filter with list-first argument order
# This enables UFCS chaining: list.map(f).filter(p)

main() = {
    numbers = [1, 2, 3, 4]

    # Using stdlib map and filter (list first, function second)
    squared_numbers = map(numbers, x => x * x)
    # squared_numbers is [1, 4, 9, 16]

    even_numbers = filter(numbers, x => x % 2 == 0)
    # even_numbers is [2, 4]

    # Or using method-style chaining (more readable)
    result = numbers.map(x => x * x).filter(x => x > 5)
    println(result)  # [9, 16]
}
</code></pre>
                </div>

                <!-- Method Chaining -->
                <h2 class="text-2xl font-semibold text-white mb-4">Method-Style Chaining</h2>
                <p class="text-slate-400 mb-4">
                    Nostos supports calling functions using dot notation, which enables fluent method-style chaining. When you write <code>x.f(y)</code>, it's equivalent to <code>f(x, y)</code>. This makes data transformation pipelines much more readable.
                </p>
                <div class="bg-nostos-code rounded-lg p-6 mb-8 border border-slate-800 overflow-x-auto">
<pre style="max-width:100%;overflow-x:auto"><code class="language-nostos">
double(x) = x * 2

main() = {
    # These are equivalent:
    result1 = double(5)
    result2 = 5.double()

    # Chaining multiple operations
    numbers = [1, 2, 3, 4, 5]

    # Without chaining (nested calls, read inside-out)
    result = sum(filter(map(numbers, x => x * 2), x => x > 2))

    # With chaining (read left-to-right) - much cleaner!
    result = numbers
        .map(x => x * 2)
        .filter(x => x > 2)
        .sum()
    # result is 24 (4 + 6 + 8 + 10)

    println(result)
}
</code></pre>
                </div>

                <p class="text-slate-400 mb-4">
                    This works with any function - the value before the dot becomes the first argument:
                </p>
                <div class="bg-nostos-code rounded-lg p-6 mb-8 border border-slate-800 overflow-x-auto">
<pre style="max-width:100%;overflow-x:auto"><code class="language-nostos">
# Define your own chainable functions
addOne(x) = x + 1
double(x) = x * 2
square(x) = x * x

main() = {
    # Chain custom functions
    result = 5.addOne().double().square()  # ((5 + 1) * 2)^2 = 144
    println(result)

    # Works with list operations too
    data = [1, 2, 3, 4, 5]
    processed = data
        .map(x => x * 10)
        .filter(x => x > 20)
        .take(2)
    println(processed)  # [30, 40]
    println(calculate(-16))  # 4
}
</code></pre>
                </div>

                <div class="bg-gradient-to-r from-blue-900/20 to-emerald-900/20 rounded-lg p-6 mb-8 border border-blue-800/30">
                    <h3 class="text-lg font-semibold text-white mb-3">Chaining Best Practices</h3>
                    <ul class="list-disc list-inside text-slate-400 space-y-2">
                        <li>Use chaining for data transformation pipelines</li>
                        <li>Break long chains across multiple lines for readability</li>
                        <li>Prefer chaining when operations flow naturally left-to-right</li>
                        <li>Use traditional function calls when order doesn't matter or for single operations</li>
                    </ul>
                </div>

                <!-- Named Parameters -->
                <h2 class="text-2xl font-semibold text-white mb-4">Named Parameters</h2>
                <p class="text-slate-400 mb-4">
                    Named parameters allow you to call functions with arguments in any order by specifying parameter names. This makes code more readable, especially for functions with many parameters.
                </p>
                <div class="bg-nostos-code rounded-lg p-6 mb-8 border border-slate-800 overflow-x-auto">
<pre style="max-width:100%;overflow-x:auto"><code class="language-nostos"># Define a function
greet(name, greeting) = greeting ++ ", " ++ name ++ "!"

# Call with named parameters (any order)
greet(name: "World", greeting: "Hello")      # "Hello, World!"
greet(greeting: "Hi", name: "Alice")         # "Hi, Alice!"

# Mix positional and named (positional must come first)
greet("Bob", greeting: "Hey")                # "Hey, Bob!"
</code></pre>
                </div>

                <p class="text-slate-400 mb-4">Named parameters work well with records:</p>
                <div class="bg-nostos-code rounded-lg p-6 mb-8 border border-slate-800 overflow-x-auto">
<pre style="max-width:100%;overflow-x:auto"><code class="language-nostos">type Point = { x: Int, y: Int, z: Int }

# Named args for record construction
p = Point(x: 10, y: 20, z: 30)

# Function with multiple point params
midpoint(p1, p2) = Point(
    x: (p1.x + p2.x) / 2,
    y: (p1.y + p2.y) / 2,
    z: (p1.z + p2.z) / 2
)

# Call with named parameters for clarity
mid = midpoint(p1: origin, p2: target)
</code></pre>
                </div>

                <!-- Default Parameter Values -->
                <h2 class="text-2xl font-semibold text-white mb-4">Default Parameter Values</h2>
                <p class="text-slate-400 mb-4">
                    Parameters can have default values, making them optional. Use the syntax <code>param = defaultValue</code> in the function definition.
                </p>
                <div class="bg-nostos-code rounded-lg p-6 mb-8 border border-slate-800 overflow-x-auto">
<pre style="max-width:100%;overflow-x:auto"><code class="language-nostos"># Parameters with default values
greet(name, greeting = "Hello", punctuation = "!") =
    greeting ++ ", " ++ name ++ punctuation

# Call with all defaults
greet("World")                    # "Hello, World!"

# Override some defaults positionally
greet("World", "Hi")              # "Hi, World!"

# Override all
greet("World", "Hey", "?")        # "Hey, World?"
</code></pre>
                </div>

                <p class="text-slate-400 mb-4">Default values can be any expression:</p>
                <div class="bg-nostos-code rounded-lg p-6 mb-8 border border-slate-800 overflow-x-auto">
<pre style="max-width:100%;overflow-x:auto"><code class="language-nostos"># Arithmetic expressions
addWithDefault(a, b = 10 * 2) = a + b
addWithDefault(5)              # 25 (b defaults to 20)

# String defaults
wrap(text, prefix = "[", suffix = "]") = prefix ++ text ++ suffix
wrap("hello")                  # "[hello]"

# List defaults
appendItem(lst, item = 0) = lst ++ [item]
appendItem([1, 2, 3])          # [1, 2, 3, 0]

# Boolean defaults
check(value, invert = false) = if invert then !value else value
check(true)                    # true
check(true, true)              # false
</code></pre>
                </div>

                <!-- Combining Named and Default Parameters -->
                <h2 class="text-2xl font-semibold text-white mb-4">Combining Named and Default Parameters</h2>
                <p class="text-slate-400 mb-4">
                    Named parameters and defaults work together powerfully - you can skip optional parameters and specify only the ones you need.
                </p>
                <div class="bg-nostos-code rounded-lg p-6 mb-8 border border-slate-800 overflow-x-auto">
<pre style="max-width:100%;overflow-x:auto"><code class="language-nostos">greet(name, greeting = "Hello", punctuation = "!") =
    greeting ++ ", " ++ name ++ punctuation

# Skip middle param using named arg
greet("World", punctuation: "?")          # "Hello, World?"

# Use named arg to override specific default
greet("World", greeting: "Hey")           # "Hey, World!"

# Named args in any order, skipping optionals
greet(punctuation: "!!!", name: "You", greeting: "Yo")  # "Yo, You!!!"

# Only required arg, all defaults
greet(name: "Friend")                     # "Hello, Friend!"
</code></pre>
                </div>

                <p class="text-slate-400 mb-4">Functions with all optional parameters:</p>
                <div class="bg-nostos-code rounded-lg p-6 mb-8 border border-slate-800 overflow-x-auto">
<pre style="max-width:100%;overflow-x:auto"><code class="language-nostos">makeRange(start = 0, stop = 10, step = 1) = (start, stop, step)

makeRange()                       # (0, 10, 1)
makeRange(5)                      # (5, 10, 1)
makeRange(stop: 20)               # (0, 20, 1)
makeRange(step: 2, stop: 20)      # (0, 20, 2)
makeRange(5, step: 3)             # (5, 10, 3)
</code></pre>
                </div>

                <div class="bg-gradient-to-r from-blue-900/20 to-emerald-900/20 rounded-lg p-6 mb-8 border border-blue-800/30">
                    <h3 class="text-lg font-semibold text-white mb-3">Best Practices</h3>
                    <ul class="list-disc list-inside text-slate-400 space-y-2">
                        <li>Put required parameters before optional ones</li>
                        <li>Use named parameters when calling functions with many arguments for clarity</li>
                        <li>Use defaults for configuration options that have sensible common values</li>
                        <li>Use named parameters to skip optional arguments you don't need</li>
                    </ul>
                </div>
            </div>

                        <!-- Navigation Buttons -->
            <div class="flex justify-between border-t border-slate-800 pt-8">
                <a href="01_basics.html" class="flex items-center text-blue-400 hover:text-blue-300 font-medium transition">
                    <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m0 0h18"></path></svg>
                    Previous: Basics
                </a>
                <a href="03_pattern_matching.html" class="flex items-center text-blue-400 hover:text-blue-300 font-medium transition">
                    Next: Pattern Matching
                    <svg class="w-5 h-5 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m0 0h18"></path></svg>
                </a>
            </div>
        </main>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="../js/nostos-highlight.js"></script>
    <script src="../js/tutorial-sidebar.js"></script>
    <script>hljs.highlightAll();</script>



</body>
